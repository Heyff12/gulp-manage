{"version":3,"sources":["b/activity_preview.js"],"names":["click_chulist","obj","$","addClass","siblings","removeClass","require","yanzheng","ajax_rule","localstorage","date_change","get_data","startime","getone_storage","startime_zu","split","text","endtime_zu","endtime","rules","JSON","parse","class_val","length","i","chu_value","pay_amt","toFixed","song_value","index_value","grid_index","eq","append","post_data","return_data","preview_data","location","href","protocol","host","document","ready","get_storage","on","data_post","get_data_all","start_time","time_change_long","end_time","rules_data","rules_data_str","rule_str","rule","stringify","get_hash","eidt"],"mappings":";;;;;;YACA,SAASA,eAAcC,GADvBC,EAAAD,GAAAE,SAAA,aAAAC,SAAA,MAAAC,YAAA,aAEIH,SAAA,qBAAA,WACHI,SAAA,QAAA,WAAA,YAAA,eAAA,eAAA,SAAAJ,EAAAK,EAAAC,EAAAC,EAAAC,GACOR,EAAC,WAwCG,QAAAS,KAEA,GAAAC,GAAAH,EAAoBI,eAAA,cAChBC,EAAAF,EAAAG,MAAA,IACIH,GACAE,EAAAA,gBAAcF,KAASG,EAA3B,GAAA,IAAAD,EAAA,GAAA,IAAAA,EAAA,GAAA,KAEIZ,EAAE,gBAAgBc,KAAKF,GAEvBZ,IAAAA,GAAEO,EAAqBI,eAAvB,YACHI,EAAAC,EAAAH,MAAA,IACGG,GACAD,EAAAA,eAAaC,KAAQH,EAAzB,GAAA,IAAAE,EAAA,GAAA,IAAAA,EAAA,GAAA,KAEIf,EAAE,eAAec,KAAKC,GAGzB,IAAAE,GAAAC,KAAAC,MAAAZ,EAAAI,eAAA,SACD,KAAAM,EACIA,OAAAA,CAEA,IAAAG,GAAA,EAEAA,GADH,GAAAH,EAAAI,OACe,SACO,GAAbA,EAANA,OACY,SAEA,EAEZD,KAAAA,GAAAA,GAAAA,EAAYE,EAAZL,EAAAI,OAAAC,IAAA,CACH,GAAAC,IAAAN,EAAAK,GAAAE,QAAA,KAAAC,QAAA,GACIC,GAAeT,EAAMI,GAAAA,YAAa,KAAAI,QAAA,GAC/BF,EAAaN,EAAAK,GAASE,WACtBE,EAAAA,iDAAJC,EAAA,YAAAP,EAAA,gCAAAG,EAAA,yBAAAG,EAAA,uEACA1B,GAAA,kBAAkBiB,OAASW,GAE3B5B,EAAAA,qBAAA6B,GAAoBC,GAAAA,SAApB,aAGP,QAAAC,GAAAC,GAEDzB,EAASwB,cAATE,GAIIC,SAAAC,KAAAD,SAAAE,SAAA,KAAAF,SAAAG,KAAA,gCAlFJ,GAAAJ,IAAA,aAAA,WAAA,QAAA,OAAA,aAAA,gBACAjC,GAAAsC,UAAAC,MAAA,WAEED,EAAFE,YAAkB/B,KAGjBT,EAHD,mBAAAyC,GAAA,QAAA,WAKE,GAAAC,GAAFnC,EAAiCoC,aAAWV,EACxCS,GAAAE,WAAApC,EAAAqC,iBAAAH,EAAAE,YAAA,YACAF,EAAIA,SAAYnC,EAAaoC,iBAAaV,EAA1Ca,UAAA,WAGA,KAAIC,GAFJL,GAAUE,KAAVzB,MAAuBX,EAAYqC,OACnCH,EAAqBlC,IACjBuC,EAAAA,EAAAA,EAAa7B,EAAWwB,OAAUzB,IAAtC,CACI+B,GACCC,GADDD,EAAAA,EAAJ1B,EAGQ2B,GADAC,KAAAA,EACJhC,KAAAiC,UAAAD,GAEehC,IAAKiC,KAAAA,UAAhBD,GAEAD,GAAWA,EAEfD,GAAAA,IACHN,EAAAzB,MAAA+B,CACDA,IAAAA,GAAAA,EAAkBI,SAAlB,OACUnC,SAAVyB,EACIW,EAAOhD,UAAS+C,mCAApB,OAAA,OAAAV,EAAA,WAAAX,GAEIzB,EAAUA,UAAU,6BAAA,OAAoC,OAAQoC,EAAQA,WAAWX","file":"../../../b/activity_preview.js","sourcesContent":["//点击储值项\nfunction click_chulist(obj) {\n    $(obj).addClass('li_choose').siblings('li').removeClass('li_choose');\n};\nrequire(['../require-config'], function() {\n    require([\"zepto\", \"yanzheng\", \"ajax_rule\", \"localstorage\", \"date_change\"], function($, yanzheng, ajax_rule, localstorage, date_change) {\n        $(function() {\n            //---取消了native if_menu的引用0106\n            //设置储值活动----------------------------------------------------------------------------------------------------------------------------------------------------\n            var preview_data = ['start_time', 'end_time', 'rules', 'desc', 'mch_mobile', 'merchant_name'];\n            $(document).ready(function() {\n                //获取初始值\n                localstorage.get_storage(get_data);\n            });\n            //点击提交预览\n            $('.js_preview_sub').on('click', function() {\n                //提交数据\n                var data_post = localstorage.get_data_all(preview_data);\n                data_post.start_time = date_change.time_change_long(data_post.start_time) + ' 00:00:00';\n                data_post.end_time = date_change.time_change_long(data_post.end_time) + ' 23:59:59';\n                var rules_data = JSON.parse(data_post.rules);\n                var rules_data_str = '[';\n                for (var i = 0; i < rules_data.length; i++) {\n                    var rule = rules_data[i];\n                    var rule_str;\n                    if (i == '0') {\n                        rule_str = JSON.stringify(rule);\n                    } else {\n                        rule_str = ',' + JSON.stringify(rule);\n                    }\n                    rules_data_str += rule_str;\n                }\n                rules_data_str += ']';\n                data_post.rules = rules_data_str;\n                var eidt = yanzheng.get_hash('edit');\n                if (eidt == 'mend') {\n                    ajax_rule.ajax_rule('/prepaid/v1/api/b/activity/alter', 'POST', 'json', data_post, '.zheceng', post_data);\n                } else {\n                    ajax_rule.ajax_rule('/prepaid/v1/api/b/activity', 'POST', 'json', data_post, '.zheceng', post_data);\n                }\n            });\n            //点击切换储值\n            // $(document).on('click', '.js_rechage_ul li', function() {\n            //     $(this).addClass('li_choose').siblings('li').removeClass('li_choose');\n            // });\n            //获取时间后设置日期显示--规则显示\n            function get_data() {\n                //日期\n                var startime = localstorage.getone_storage('start_time');\n                var startime_zu = startime.split('-');\n                if (startime) {\n                    $('.js_startime').text(startime_zu[0] + '年' + startime_zu[1] + '月' + startime_zu[2] + '日');\n                } else {\n                    $('.js_startime').text('');\n                }\n                var endtime = localstorage.getone_storage('end_time');\n                var endtime_zu = endtime.split('-');\n                if (endtime) {\n                    $('.js_endtime').text(endtime_zu[0] + '年' + endtime_zu[1] + '月' + endtime_zu[2] + '日');\n                } else {\n                    $('.js_endtime').text('');\n                }\n                //储值规则--有退出，放置最后\n                var rules = JSON.parse(localstorage.getone_storage('rules'));\n                if (!rules) {\n                    return false;\n                }\n                var class_val = '';\n                if (rules.length == 1) {\n                    class_val = 'li_one';\n                } else if (rules.length == 2) {\n                    class_val = 'li_two';\n                } else {\n                    class_val = '';\n                }\n                for (var i = 0; i < rules.length; i++) {\n                    var chu_value = (rules[i].pay_amt / 100).toFixed(0);\n                    var song_value = (rules[i].present_amt / 100).toFixed(0);\n                    var index_value = rules[i].grid_index;\n                    var rule_li = '<li onclick=\"click_chulist(this)\" data-index=\"' + index_value + '\" class=\"' + class_val + '\"><p class=\"font_17\">储值<span>' + chu_value + '</span>元</p><p>送<span>' + song_value + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                    $('.js_rechage_ul').append(rule_li);\n                }\n                $('.js_rechage_ul li').eq(0).addClass('li_choose');\n            }\n            //提交数据\n            function post_data(return_data) {\n                //清空数据\n                localstorage.clean_storage(preview_data);\n                //调到储值活动首页todo\n                // var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/index.html';\n                // if_menu.goto_url(url_val);\n                location.href = location.protocol + '//' + location.host + '/prepaid/v1/page/b/index.html';\n                // if (typeof QFPAY !== \"undefined\") {\n                //     var go_url = {\n                //         uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/index.html',\n                //     };\n                //     native.openUri(go_url, function(cb) {\n                //         console.log(cb.ret);\n                //     });\n                //     //暂时隐藏关闭所有---下次版本更新使用\n                //     // var close_url = {};\n                //     // native.closeAll(close_url, function(cb) {\n                //     //     console.log(cb.ret);\n                //     // });\n                // } else {\n                //     location.href = location.protocol + '//' + location.host + '/prepaid/v1/page/b/index.html';\n                // }\n            }\n        });\n    });\n});\n"]}