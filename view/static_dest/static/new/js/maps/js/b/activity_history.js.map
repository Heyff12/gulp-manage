{"version":3,"sources":["b/activity_history.js"],"names":["require","$","ajax_rule","scroll_more","date_change","get_history","data","pos","val","get_list","return_data","length","hide","addClass","show","removeClass","i","item","startime","start_time","each","endtime","end_time","user_num","activity_id","toFixed","total_txamt","total_pay_amt","detail","s_time","time_change_word","e_time","p_str","ul_str","rule_str","grid_index","title","li_detail","append","pos_val","nomor_show","scroll_data","window","setTimeout","nomoredata_hide","nomoredata_show","scroll_if","Math","floor","height","add_load_img","document"],"mappings":";;;;;;YAAAA,UAAS,qBAAsB,WAC3BA,SAAS,QAAS,YAAa,cAAe,eAAgB,SAASC,EAAGC,EAAWC,EAAaC,GAD9FH,EAAC,WAYI,QAHDI,KAIA,GAAAC,IACAC,IAASF,EAAAA,WAAcG,MACfF,MAAO,GAEPJ,GAAAA,UAAS,qCAAA,MAAA,OAAAI,EAAA,WAAAG,GAGhB,QAAAA,GAAAC,GACD,GAAA,GAAAA,EAAAC,QAAA,KAAAV,EAAA,WAAAO,MAIQP,MAHRA,GAASQ,eAASC,OACXA,EAAAA,6BAA2BE,OAC1BX,EAAE,QAAAY,SAAeC,aACf,CAEFb,GAAA,eAAAW,OAJJX,EAAA,6BAKKa,OACDb,EAAE,QAAAc,YAAF,YAEAd,EAAAA,GAAUc,KAAAA,SAAYC,EAAAC,GACzB,GAAAC,GAAAR,EAAAM,GAAAG,WACCT,EAAaU,EAAcJ,GAAGC,SACxBC,EAAWR,EAAeS,GAAAA,YAC1BE,EAAUX,EAAAM,GAAeM,SAEzBC,IADcb,EAAAM,GAAeQ,YAAjC,KAAAC,QAAA,IACef,EAAea,GAAAA,cAA9B,KAAAE,QAAA,IACIC,EAAAA,EAAehB,GAAAA,OACfiB,EAAAA,EAAiBjB,iBAAeiB,GAChCC,EAASlB,EAAYM,kBAAWE,EAAAG,GAChCQ,EAAAA,mBAAqBC,EAAiBZ,IAAAA,EAA1C,OACIa,EAAS3B,mFAAbmB,EAAA,gFAAAI,EAAA,yBACIK,EAAQ,oBACZ/B,GAAA2B,GAAIK,KAAS,SAAAjB,EAAAC,GACTiB,GAAAA,GAAWN,EAAAZ,GAAAmB,WACfC,EAAeR,EAAAZ,GAAAoB,MACPD,EAAAA,EAAaP,GAAAL,SACba,EAAQR,mBAAZO,EAAA,0CAAAZ,EAAA,kBAAAa,EAAA,OACAF,IAAIX,IAEJW,GAAAA,OACH,IANDG,GAAA,wBAAAb,EAAA,6BAAAQ,EAAAC,EAAAC,EAAA,YAOAA,GAAAA,6BAAAI,OAAAD,KAEApC,EAAAA,SAAEW,MACL,IAvBD2B,GAAAtC,EAAA,WAAAO,MAAA,CAwBEE,GAAFC,OAAA,IACI4B,EAAY5B,OAAWH,EACvBE,EAAYC,YAAa6B,YAAA,GAErBrC,EAAYsC,kBADhBC,OAEOC,WAAAxC,EAAAyC,gBAAA,KACHzC,EAAY0C,YAAAA,YAAZ,GAEA1C,EAAAA,YAAYsC,WAAYD,IAE5BrC,GAAAA,GARJF,EAAA,WASOO,IAAA+B,GACHA,EAAWE,YAAXK,WAAA,GAEA3C,EAAAA,YAAYsC,YAAZM,KAAoCC,MAApC/C,EAAA,QAAAgD,UAAAxB,QAAA,GApERtB,EAAA+C,aAAA,QAEA/C,EAAY+C,YAAZ7C,GAEAF,EAAAA,UAAYA,MAAAA,WAEVgD","file":"../../../b/activity_history.js","sourcesContent":["require(['../require-config'], function() {\n    require([\"zepto\", \"ajax_rule\", \"scroll_more\", \"date_change\"], function($, ajax_rule, scroll_more, date_change) {\n        $(function() {\n            //滚动加载---------------------------------------------------------------  \n            //添加图标和没有更多文字提示\n            scroll_more.add_load_img('#wap');\n            //默认滚动执行   \n            scroll_more.scroll_more(get_history);\n            //设置储值活动----------------------------------------------------------------------------------------------------------------------------------------------------\n            $(document).ready(function() {\n                //获取信息--todo\n                get_history();\n            });\n            //获取活动列表\n            function get_history() {\n                var data = {\n                    'pos': $('#js_pos').val(),\n                    'count': 10,\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/b/activity_history', 'GET', 'json', data, '.zheceng', get_list);\n            }\n            //获取列表成功数据\n            function get_list(return_data) {\n                if(return_data.length==0 && $('#js_pos').val()=='0'){\n                    $('.js_li_none').show();\n                    $('.js_activityhistory_index').hide();\n                    $('body').addClass('bg_white');\n                    return false;\n                }else{\n                    $('.js_li_none').hide();\n                    $('.js_activityhistory_index').show();\n                    $('body').removeClass('bg_white');\n                }\n                $(return_data).each(function(i, item) {\n                    var startime = return_data[i].start_time;\n                    var endtime = return_data[i].end_time;\n                    var activity_id = return_data[i].activity_id;\n                    var user_num = return_data[i].user_num;\n                    var total_txamt = (return_data[i].total_txamt / 100).toFixed(0);\n                    var total_pay_amt = (return_data[i].total_pay_amt / 100).toFixed(0);\n                    var detail = return_data[i].detail; //活动信息\n                    var s_time = date_change.time_change_word(startime);\n                    var e_time = date_change.time_change_word2(startime, endtime);\n                    var p_str = '<p class=\"time\">' + s_time + '-' + e_time + '</p>';\n                    var ul_str = '<ul class=\"message\"><li>会员数<br/><span class=\"span_num\"><i class=\"js_all_person\">' + user_num + '</i>人</span></li><li>储值金额<br/><span class=\"span_num\"><i class=\"js_all_money\">' + total_pay_amt + '</i>元</span></li></ul>';\n                    var rule_str = '<ul class=\"rules\">';\n                    $(detail).each(function(i, item) {\n                        var grid_index = detail[i].grid_index;\n                        var title = detail[i].title;\n                        var user_num = detail[i].user_num;\n                        var li_str = '<li data-index=\"' + grid_index + '\"><span class=\"fr\"><i class=\"i_normal\">' + user_num + '人</i>已购买</span>' + title + '</li>';\n                        rule_str += li_str;\n                    });\n                    rule_str += '</ul>';\n                    var li_detail = '<section data-index=\"' + activity_id + '\" class=\"section_history\">' + p_str + ul_str + rule_str + '</section>';\n                    $(\".js_activityhistory_index\").append(li_detail);\n                });\n                $('.load').hide();\n                var pos_val = $('#js_pos').val() - 0;\n                if (return_data.length < 10) {\n                    if (return_data.length > 0) {\n                        scroll_more.scroll_data.nomor_show = true;\n                    } else {\n                        scroll_more.nomoredata_show();\n                        window.setTimeout(scroll_more.nomoredata_hide, 2000);\n                        scroll_more.scroll_data.nomor_show = false;\n                    }\n                    scroll_more.scroll_data.scroll_if = false;\n                } else {\n                    pos_val += 10;\n                    $('#js_pos').val(pos_val);\n                    scroll_more.scroll_data.scroll_if = true;\n                }\n                scroll_more.scroll_data.body_height = Math.floor($('body').height()).toFixed(0);\n                // console.log('AJAX:scroll_more.scroll_data.body_height==' + scroll_more.scroll_data.body_height);\n                // console.log('AJAX:scroll_if==' + scroll_more.scroll_data.scroll_if);\n                // console.log('AJAX:nomor_show==' + scroll_more.scroll_data.nomor_show);\n            }\n        });\n    });\n});\n"]}