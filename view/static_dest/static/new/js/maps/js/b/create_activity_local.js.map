{"version":3,"sources":["b/create_activity_local.js"],"names":["delete_rule","obj","dd_list","$","length","remove","parents","removeClass","css","require","yanzheng","ajax_rule","localstorage","iosselect","date_get","alert_word","time_area","startime","endtime","val","tips_pic","attr","s_year","s_month","s_day","e_year","e_month","e_day","s_time","e_time","s_time_s","Date","getTime","today_time_s","today_times","s_cha","e_time_s","find","html","addClass","get_data","focus","wordtip","text","startime_zu","split","data","nowYear","nowMonth","nowDate","endtime_zu","rules_t","getone_storage","rules","JSON","parse","eq","append","i","chu_value","pay_amt","toFixed","song_value","index_value","grid_index","dd_detail","toast_data_short","document","get_storage","on","showDom","querySelector","year","dataset","yearData","monthData","dateData","container","bankSelect","title","itemHeight","itemShowCount","relation","month","oneLevelId","threeLevelId","year_data","month_data","day_data","id","callback","this","crash_now_str","replace","crash_now_strend","crash_end_z","crash_end_z_first","substr","crash_end_l","len_val","len","tel_activity","name_test","numprice_test","hasClass","each","error_len","set_storage","chu_len","chu_html","chu_val","song_key","present_amt","song_val","push","stringify","setone_storage"],"mappings":"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","file":"../../../b/create_activity_local.js","sourcesContent":["//删除规则\nfunction delete_rule(obj) {\n    var dd_list = $('.js_rule dd').length - 0;\n    if (dd_list == 2) {\n        //删除第一条数据后面的删除按钮\n        $(obj).parents('dd').remove();\n        $('.js_rule dd i.js_ruledelete').remove();\n    }\n    $(obj).parents('dd').remove();\n    $('.js_rule_error').removeClass('span_tips');\n    $('.js_add_activity').find('.add_rule').css('display', 'inline-block');\n    $('.js_add_activity').find('.add_rule_no').css('display', 'none');\n}\nrequire(['../require-config'], function() {\n    require([\"zepto\", \"yanzheng\", \"ajax_rule\", \"localstorage\", \"iosselect\", \"date_get\", \"alert_word\"], function($, yanzheng, ajax_rule, localstorage, iosselect, date_get, alert_word) {\n        $(function() {\n            //加载提示弹框\n            alert_word.toast_data_short('body', '储值金额不可超过2000元');\n            var today_times = date_get.nowYear + '/' + date_get.nowMonth + '/' + date_get.nowDate + ' 00:00:00';\n            //设置储值活动----------------------------------------------------------------------------------------------------------------------------------------------------\n            $(document).ready(function() {\n                //获取店铺名称\n                var data_shopname = {};\n                //ajax_rule.ajax_rule('/prepaid/v1/api/b/merchant_info', 'GET', 'json', '', '.zheceng', get_shopname);\n                //获取初始值\n                localstorage.get_storage(get_data);\n            });\n            //点击开始时间\n            $('.js_startime').on('click', function() {\n                var showDom = document.querySelector('.js_startime');\n                var year = showDom.dataset['year'];\n                var month = showDom.dataset['month'];\n                var day = showDom.dataset['day'];\n\n                var bankSelect = new iosselect(3, [date_get.yearData, date_get.monthData, date_get.dateData], {\n                    container: '.ios_select_container',\n                    title: '选择开始时间',\n                    itemHeight: 50,\n                    itemShowCount: 3,\n                    relation: [1, 1, 0, 0],\n                    oneLevelId: year,\n                    twoLevelId: month,\n                    threeLevelId: day,\n                    //showLoading: true,\n                    callback: function(year_data, month_data, day_data) {\n                        showDom.dataset['year'] = year_data.id;\n                        showDom.dataset['month'] = month_data.id;\n                        showDom.dataset['day'] = day_data.id;\n                        showDom.value = month_data.id + '月' + day_data.id + '日';\n                        $('#startime').val(year_data.id + '-' + month_data.id + '-' + day_data.id);\n                        //设置结束时间的默认时间--开始时间\n                        // $('.js_endtime').attr('data-year', year_data.id);\n                        // $('.js_endtime').attr('data-month', month_data.id);\n                        // $('.js_endtime').attr('data-day', day_data.id);\n                    }\n                });\n            });\n            //点击到期时间\n            $('.js_endtime').on('click', function() {\n                var showDom = document.querySelector('.js_endtime');\n                var year = showDom.dataset['year'];\n                var month = showDom.dataset['month'];\n                var day = showDom.dataset['day'];\n\n                var bankSelect = new iosselect(3, [date_get.yearData, date_get.monthData, date_get.dateData], {\n                    container: '.ios_select_container',\n                    title: '选择结束时间',\n                    itemHeight: 50,\n                    itemShowCount: 3,\n                    relation: [1, 1, 0, 0],\n                    oneLevelId: year,\n                    twoLevelId: month,\n                    threeLevelId: day,\n                    //showLoading: true,\n                    callback: function(year_data, month_data, day_data) {\n                        showDom.dataset['year'] = year_data.id;\n                        showDom.dataset['month'] = month_data.id;\n                        showDom.dataset['day'] = day_data.id;\n                        showDom.value = month_data.id + '月' + day_data.id + '日';\n                        $('#endtime').val(year_data.id + '-' + month_data.id + '-' + day_data.id);\n                    }\n                });\n            });\n            //点击增加规则\n            $('.js_add_activity').on('click', function() {\n                var dd_list = $('.js_rule dd').length - 0;\n                var dd_detail = '<dd data-index=\"\">储值<input class=\"text text_short js_chu js_storule\" type=\"tel\" value=\"\" name=\"pay_amt\" />元送<input class=\"text text_short js_song js_storule\" type=\"tel\" value=\"\" name=\"present_amt\" />元<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i></dd>';\n                if (dd_list <= 3) {\n                    if (dd_list == 1) {\n                        //第一条增加删除按钮\n                        $('.js_rule dd').append('<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i>');\n                    }\n                    if (dd_list == 3) {\n                        //设置为不可添加的按钮样式\n                        $(this).find('.add_rule').css('display', 'none');\n                        $(this).find('.add_rule_no').css('display', 'inline-block');\n                    }\n                    $('.js_rule').append(dd_detail);\n                    $('.js_rule_error').removeClass('span_tips');\n                } else {\n                    $('.js_rule_error').addClass('span_tips');\n                }\n            });\n            //点击删除规则\n            // $(document).on('click', '.js_ruledelete', function() {\n            //     var dd_list = $('.js_rule dd').length - 0;\n            //     if (dd_list == 2) {\n            //         //删除第一条数据后面的删除按钮\n            //         $(this).parents('dd').remove();\n            //         $('.js_rule dd i.js_ruledelete').remove();\n            //     }\n            //     $(this).parents('dd').remove();\n            //     $('.js_rule_error').removeClass('span_tips');\n            //     $('.js_add_activity').find('.add_rule').css('display', 'inline-block');\n            //     $('.js_add_activity').find('.add_rule_no').css('display', 'none');\n            // });\n            //填写储值赠送金额\n            $(document).on('input', '.js_storule', function() {\n                var crash_now_str = $(this).val();\n                //将非数字的字符替换为空\n                var crash_now_strend = crash_now_str.replace(/[^\\d]/g, '');\n                //如果输入为空展示全部提现\n                if (crash_now_strend.length == 0) {\n                    $(this).val('');\n                    return false;\n                }\n                if (crash_now_strend.length == 1 && crash_now_strend == '0') {\n                    $(this).val('');\n                    return false;\n                }\n                //整数部分最长4位start，且不大于2000\n                var crash_end_z = crash_now_strend.split('.')[0];\n                //如果整数部分首位为0，则截取后买的 \n                var crash_end_z_first = crash_end_z.substr(0, 1);\n                if (crash_end_z_first == '0') {\n                    crash_end_z = crash_end_z.substr(1);\n                }\n                if (crash_end_z.length > 4) {\n                    crash_end_z = crash_end_z.substr(0, 4);\n                }\n                if (crash_now_strend.split('.').length > 1) {\n                    var crash_end_l = crash_now_strend.split('.')[1].substr(0, 2);\n                    crash_now_strend = (crash_end_z - 0) + '.' + crash_end_l;\n                } else {\n                    crash_now_strend = crash_end_z - 0;\n                }\n                // if(crash_now_strend>2000){\n                //     $(this).addClass('error_tips');\n                // }else{\n                //     $(this).removeClass('error_tips');\n                // }\n                //整数部分最长12位end\n                //控制输入长度后赋值并将该值转化为字符串格式\n                $(this).val(crash_now_strend);\n            });\n            //填写备注验证\n            $('.js_note').on('input', function() {\n                var len_val = $(this).val();\n                var len = len_val.length - 0;\n                if (len <= 40) {\n                    $('.js_wordtip').find('span').text(40 - len);\n                } else {\n                    //$('.js_note').val(len_val.substr(0, 40));\n                    return false;\n                }\n            });\n            // $('.js_note').on({\n            //     // 'keydown': function() {\n            //     //     var len_val = $(this).val();\n            //     //     var len = len_val.length - 0;\n            //     //     if (len <= 40) {\n            //     //         $('.js_wordtip').find('span').text(40 - len);\n            //     //     } else {\n            //     //         $('.js_note').val(len_val.substr(0, 400));\n            //     //         return false;\n            //     //     }\n            //     //     console.log(len_val);\n            //     //     console.log(len);\n            //     // },\n            //     'input': function() {\n            //         var len_val = $(this).val();\n            //         var len = len_val.length - 0;\n            //         if (len <= 40) {\n            //             $('.js_wordtip').find('span').text(40 - len);\n            //         } else {\n            //             //$('.js_note').val(len_val.substr(0, 40));                     \n            //             return false;\n            //         }\n            //         console.log(len_val);\n            //         console.log(len);\n            //     },\n            //     // 'input':function(){\n            //     //     var len_val = $(this).val();\n            //     //     $('.js_note').val(len_val.substr(0, 40));\n            //     // },\n            //     // 'keyup':function(){\n            //     //     var len_val = $(this).val();\n            //     //     $('.js_note').val(len_val.substr(0, 40));\n            //     // }\n            // });\n            function callback(){\n                var len_val = $('.js_note').val();\n                $('.js_note').val(len_val.substr(0, 40));\n            }\n            //点击提交预览\n            $('.js_addactivity_sub').on('click', function() {\n                yanzheng.tel_activity('.js_tel');\n                yanzheng.name_test('.js_note', 0, 40);\n                time_area();\n                $('.js_storule').each(function() {\n                    yanzheng.numprice_test(this, 0, 4, 2000);\n                });\n                $('.js_storule').each(function() {\n                    if ($(this).hasClass('error_tips')) {\n                        alert_word.alert_word_show_short();\n                        return false;\n                    }\n                });\n                var error_len = $('.error_tips').length;\n                if (error_len > 0) {\n                    return false;\n                }\n                //存储数据并进入下一步\n                localstorage.set_storage();\n                //存储储值规则\n                var rules = [];\n                var chu_len = $('.js_rule dd').length;\n                for (var i = 0; i < chu_len; i++) {\n                    var chu_html = $('.js_rule dd').eq(i);\n                    var chu_key = chu_html.find('.js_chu').attr('name');\n                    var chu_val = chu_html.find('.js_chu').val();\n                    var song_key = chu_html.find('.js_song').attr('name');\n                    var song_val = chu_html.find('.js_song').val();\n                    var rule = { grid_index: i + 1, pay_amt: chu_val * 100, present_amt: song_val * 100 };\n                    rules.push(rule);\n                }\n                localstorage.setone_storage('rules', JSON.stringify(rules));\n                //location.href = location.protocol + '//' + location.host + '/Users/yaya/Documents/job/local/储值B端2/store/html/b/activity_preview.html';\n                location.href = location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_preview.html';\n            });\n            //开始时间与结束时间的判断\n            function time_area() {\n                var startime = $('.js_startime');\n                var endtime = $('.js_endtime');\n                var tips_pic = '<i class=\"ic_tips\"></i>';\n                if (startime.val() && endtime.val()) {\n                    var s_year = startime.attr('data-year');\n                    var s_month = startime.attr('data-month');\n                    var s_day = startime.attr('data-day');\n                    var e_year = endtime.attr('data-year');\n                    var e_month = endtime.attr('data-month');\n                    var e_day = endtime.attr('data-day');\n                    var s_time = s_year + '/' + s_month + '/' + s_day + ' 00:00:00';\n                    var e_time = e_year + '/' + e_month + '/' + e_day + ' 23:59:59';\n                    var s_time_s = new Date(s_time).getTime();\n                    var e_time_s = new Date(e_time).getTime();\n                    var today_time_s = new Date(today_times).getTime();\n                    var s_cha = e_time_s - s_time_s;\n                    if (s_time_s - today_time_s < 0) {\n                        $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '开始不能比今天早');\n                        return false;\n                    } else {\n                        $('.js_timetips').removeClass('error_tips').find('span').html('');\n                    }\n                    if (e_time_s - s_time_s > 365 * 24 * 60 * 60 * 1000) {\n                        $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '时间范围在365天之内');\n                    } else if (e_time_s - s_time_s >= 0) {\n                        $('.js_timetips').removeClass('error_tips').find('span').html('');\n                    } else {\n                        $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '结束时间不能比开始时间早');\n                    }\n                } else {\n                    $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '时间范围在365天之内');\n                }\n            }\n            //获取时间后设置日期显示\n            function get_data() {\n                //添加选中事件，以便textarea数值显示\n                $('.js_startime').focus(); //该输入框input为readonly不会触发输入框事件\n                //剩余可输入字数\n                var wordtip = $('.js_note').val().length - 0;\n                $('.js_wordtip span').text(40 - wordtip);\n                //日期\n                var startime = $('#startime').val();\n                var startime_zu = startime.split('-');\n                if (startime) {\n                    $('.js_startime').data('year', startime_zu[0]);\n                    $('.js_startime').data('month', startime_zu[1]);\n                    $('.js_startime').data('day', startime_zu[2]);\n                    $('.js_startime').val(startime_zu[1] + '月' + startime_zu[2] + '日');\n                } else {\n                    $('.js_startime').data('year', date_get.nowYear);\n                    $('.js_startime').data('month', date_get.nowMonth);\n                    $('.js_startime').data('day', date_get.nowDate);\n                    $('#startime').val(date_get.nowYear + '-' + date_get.nowMonth + '-' + date_get.nowDate);\n                    $('.js_startime').val('今天');\n                }\n                var endtime = $('#endtime').val();\n                var endtime_zu = endtime.split('-');\n                if (endtime) {\n                    $('.js_endtime').data('year', endtime_zu[0]);\n                    $('.js_endtime').data('month', endtime_zu[1]);\n                    $('.js_endtime').data('day', endtime_zu[2]);\n                    $('.js_endtime').val(endtime_zu[1] + '月' + endtime_zu[2] + '日');\n                } else {\n                    $('.js_endtime').data('year', date_get.nowYear);\n                    $('.js_endtime').data('month', date_get.nowMonth);\n                    $('.js_endtime').data('day', date_get.nowDate);\n                    $('#endtime').val(date_get.nowYear + '-' + date_get.nowMonth + '-' + date_get.nowDate);\n                    $('.js_endtime').val('');\n                }\n                //储值规则--有退出，放置最后\n                var rules_t = localstorage.getone_storage('rules');\n                if (!rules_t) {\n                    return false;\n                }\n                var rules = JSON.parse(rules_t);\n                if (rules.length > 1) {\n                    $('.js_rule dd').eq(0).append('<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i>');\n                } else {\n                    $('.js_rule dd').eq(0).find('i.js_ruledelete').remove();\n                }\n                if (rules.length >= 4) {\n                    $('.js_rule').find('.add_rule').css('display', 'none');\n                    $('.js_rule').find('.add_rule_no').css('display', 'inline-block');\n                } else {\n                    $('.js_rule').find('.add_rule').css('display', 'inline-block');\n                    $('.js_rule').find('.add_rule_no').css('display', 'none');\n                }\n                for (var i = 0; i < rules.length; i++) {\n                    var chu_value = (rules[i].pay_amt / 100).toFixed(0);\n                    var song_value = (rules[i].present_amt / 100).toFixed(0);\n                    var index_value = rules[i].grid_index;\n                    if (i == 0) {\n                        $('.js_rule dd').eq(0).find('.js_chu').val(chu_value);\n                        $('.js_rule dd').eq(0).find('.js_song').val(song_value);\n                        $('.js_rule dd').eq(0).attr('data-index', index_value);\n                    } else {\n                        var dd_detail = '<dd data-index=\"' + index_value + '\">储值<input class=\"text text_short js_chu js_storule\" type=\"tel\" value=\"' + chu_value + '\" name=\"chu\" />元送<input class=\"text text_short js_song js_storule\" type=\"tel\" value=\"' + song_value + '\" name=\"song\" />元<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i></dd>';\n                        $('.js_rule').append(dd_detail);\n                    }\n                }\n            }\n            //获取店铺名称\n            function get_shopname(return_data) {\n                $('.js_shopname').val(return_data);\n            }\n        });\n    });\n});\n"]}